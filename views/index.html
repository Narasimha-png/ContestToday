<!DOCTYPE html>
<html lang="en">

<head>
  <title>Contest Today</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="logo.png" type="image/png">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="index.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Import Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-messaging.js"></script>
</head>

<body>
  <nav class="navbar navbar-expand-lg bg-body-tertiary" data-bs-theme="dark" id="Home">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">
        <img id="logo" src="logo.png" alt="Bootstrap" width="30" height="24">
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="#Home">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#plat">Platforms</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#abt">About Us</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#cntus">Contact Us</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <header class="main" id="notgranted" data-bs-theme="dark">
    <p class="mainheading">Contest Today</p>
    <p class="heading">( Allow Notification Access ) => { </p>
  
      <button id="notify">To Get Notified!</button>

    <p class="heading">}</p>
  </header>
  <header class="success main" id="granted" data-bs-theme="dark">
    <p class="heading">Thanks for Subscribing ; </p>
    <p class="heading" style="text-align: center;"> We will Notify the Contest timings @ 1:00 AM everyday </p>
  </header>
  <section id="plat">
    <p class="heading fontblack" style="text-align: center;">Here are the Platforms which we notify</p>
    <div class="outerdiv">
      <div class="card">
        <img class="logoimg" src="logos/cf.png" alt="">
        <p class="fontblack card-text" style="text-align: center;">Code Forces</p>
      </div>
      <div class="card">
        <img class="logoimg" src="logos/lc.png" alt="">
        <p class="fontblack card-text" style="text-align: center;">LeetCode</p>
      </div>
      <div class="card">
        <img class="logoimg" src="logos/cc.png" alt="">
        <p class="fontblack card-text" style="text-align: center;">Code Chef</p>
      </div>
      <div class="card">
        <img class="logoimg" src="logos/gfg.png" alt="">
        <p class="fontblack card-text" style="text-align: center;">Geeks for Geeks</p>
      </div>
      <div class="card">
        <img class="logoimg" src="logos/CN.jpg" alt="">
        <p class="fontblack card-text" style="text-align: center;">Coding Ninjas</p>
      </div>
    </div>
  </section>
  <article>
    <p class="heading" style="text-align: center;" id="abt">About Us</p>
    <ul>
      <li>We will notify the contests in above mentioned coding platforms.</li>
      <li>As we forget about the contest. It reminds you every day, if contests are there @ 01:00 AM.</li>
      <li>Updates will be available soon.</li>
      <li> Thank You</li>
    </ul>
  </article>
  <div class="form" id="cntus">
    <p style="text-align: center;" class="heading fontblack">Contact Us</p>
    <form id="cntus">
      <div class="form-group">
        <label for="exampleFormControlInput1">Email address</label>
        <input type="email" class="form-control" id="exampleFormControlInput1" placeholder="name@example.com">
      </div>
      <div class="form-group">
        <label for="exampleFormControlTextarea1">Message</label>
        <textarea class="form-control" id="exampleFormControlTextarea1" rows="3"></textarea>
      </div>
    </form>
  </div>
  <footer style="text-align: center; padding: 20px;">
    Made with ❤️ by <a href="https://www.linkedin.com/in/narasimhas9490/">narasimha_tiger_</a>
  </footer>
  <script type="module">
     if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('firebase-messaging-sw.js').then((registration) => {
        console.log('Service Worker registered with scope:', registration.scope);
      }).catch((error) => {
        console.error('Service Worker registration failed:', error);
      });
    }
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getMessaging, getToken } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-messaging.js";
    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyCx0kKuGgYDgqOQDLfQcwe3y4C5hiONPoo",
      authDomain: "contesttoday-1bd6c.firebaseapp.com",
      databaseURL: "https://contesttoday-1bd6c-default-rtdb.firebaseio.com",
      projectId: "contesttoday-1bd6c",
      storageBucket: "contesttoday-1bd6c.appspot.com",
      messagingSenderId: "758562198147",
      appId: "1:758562198147:web:384d7222720a64233641b6",
      measurementId: "G-VYW8YZD5EK"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const messaging = getMessaging(app);
  // Service Worker Registration
 
  if (Notification.permission == 'granted') {
    document.getElementById("notgranted").style.display = "none";
    document.getElementById("granted").style.display = "flex";
  }

  document.getElementById("notify").addEventListener("click", function () {
    if (Notification.permission === 'denied') {
      alert('Notification permission is denied. Click on "i" side to home symbol at top and reset permissions.');
    }
   else{
    Notification.requestPermission().then((permission) => {
    if (permission === 'granted') {
      console.log('Notification permission granted.');
      return getToken(messaging, {
        vapidKey: 'BFmx8k0QRfmZvyN9jo23jfHH57117dy_MD90RG4U1hIJTthp7tGJo8Ziig9Z_DxnvTTJzepYOj4SDOJObP8T9Ic' 
      });
    } else {
      throw new Error('Notification permission not granted');
    }
  })
  .then((token) => {
    console.log('FCM Token:', token);

    // Send the token to your server
    return fetch('/store-fcm-token', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ token })
    });
  })
  .then((response) => {
    if (response.ok) {
      console.log('FCM Token sent to server successfully');
    } else {
      throw new Error('Failed to send FCM token to server');
    }
  })
  .catch((err) => {
    console.error('Unable to get permission to notify.', err);
  });
location.reload();
   }
      
  });




  </script>
</body>

</html>
